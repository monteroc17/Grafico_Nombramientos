export default class Datos {
    constructor() {
        this.datos = [{ "rdia": "2019-01-01", "rporcentaje": "120", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-02", "rporcentaje": "100", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-03", "rporcentaje": "45", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-04", "rporcentaje": "89", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-05", "rporcentaje": "12", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-06", "rporcentaje": "44", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-07", "rporcentaje": "81", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-08", "rporcentaje": "50", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-09", "rporcentaje": "69", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-10", "rporcentaje": "101", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-11", "rporcentaje": "99", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-12", "rporcentaje": "40", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-13", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-14", "rporcentaje": "70", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-15", "rporcentaje": "69", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-16", "rporcentaje": "88", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-17", "rporcentaje": "10", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-18", "rporcentaje": "0", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-19", "rporcentaje": "45", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-20", "rporcentaje": "23", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-21", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-22", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-23", "rporcentaje": "99", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-24", "rporcentaje": "67", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-25", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-26", "rporcentaje": "125", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-27", "rporcentaje": "111", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-28", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-29", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-30", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-01-31", "rporcentaje": "76", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-01", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-02", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-03", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-04", "rporcentaje": "60", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-05", "rporcentaje": "43", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-06", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-07", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-08", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-09", "rporcentaje": "69", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-10", "rporcentaje": "20", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-11", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-12", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-13", "rporcentaje": "8", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-14", "rporcentaje": "9", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-15", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-16", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-17", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-18", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-19", "rporcentaje": "199", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-20", "rporcentaje": "67", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-21", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-22", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-23", "rporcentaje": "90", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-24", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-25", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-26", "rporcentaje": "45", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-27", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-02-28", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-01", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-02", "rporcentaje": "160", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-03", "rporcentaje": "98", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-04", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-05", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-06", "rporcentaje": "69", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-07", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-08", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-09", "rporcentaje": "23", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-10", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-11", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-12", "rporcentaje": "8", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-13", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-14", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-15", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-16", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-17", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-18", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-19", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-20", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-21", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-22", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-23", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-24", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-25", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-26", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-27", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-28", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-29", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-30", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }, { "rdia": "2019-03-31", "rporcentaje": "80", "ridnombramientos": "{41433,41434}" }];
    }

    obtenerDatos() {
        return this.datos
    }

    /**
     * filtra el JSON por mes
     */
    filtrarPorMes() {
        let meses = [];
        this.datos.forEach(e => {
            meses.push(e.rdia.split('-')[1]);
        });
        meses = meses.sort().filter((item, pos, ary) => {
            return !pos || item != ary[pos - 1];
        });
        let res = [];
        meses.forEach(mes => {
            res.push({
                [mes]: this.obtenerValores(this.datos.filter(elemento => {
                    return elemento.rdia.split('-')[1] === mes; // filtra la lista por mes
                }))
            });
        });
        return res;
    }

    /**
     * filtra el JSON por año
     */
    filtrarPorAño() {
        let año = [];
        this.datos.forEach(e => {
            año.push(e.rdia.split('-')[0]);
        });
        if(año.length > 1){
            año = año.sort().filter((item, pos, ary) => {
                return !pos || item != ary[pos - 1];
            });
        }
        let res = [];
        año.forEach(año => {
            res.push({
                [año]: this.obtenerValores(this.datos.filter(elemento => {
                    return elemento.rdia.split('-')[0] === año; // filtra la lista por mes
                }))
            });
        });
        return res;
    }

    /**
     * Obtiene el porcentaje minimo y maximo de una lista dada
     * @param {object} lista 
     */
    obtenerValores(lista) {        
        return [this.obtenerMenor(lista), this.obtenerMayor(lista)];
    }

    /**
     * obtiene el elemento menor del JSON
     * @param {object} lista 
     */
    obtenerMenor(lista){
        let elementoMin;
        let min = 200;
        lista.forEach(elemento => {
            if (parseInt(elemento.rporcentaje) <= min) {
                elementoMin = elemento;
                min = elemento.rporcentaje;
            }
        });
        return elementoMin;
    }

    /**
     * obtiene el elemento mayor del JSON
     * @param {object} lista 
     */
    obtenerMayor(lista){
        let elementoMax;
        let max = 0;
        lista.forEach(elemento => {
            if (parseInt(elemento.rporcentaje) >= max) {
                elementoMax = elemento;
                max = elemento.rporcentaje;
            }
        });
        return elementoMax;
    }
    /**
     * carga programaticamente el JSON en el html
     * @param {object} lista 
     */
    cargarGrafico(lista) {
        let container = document.getElementById('chartDiv');
        for(var i = 0; i < lista.length; i++) {
            var barra = document.createElement('div');
            barra.style.height = Math.floor(parseInt(lista[i].rporcentaje)/2) + '%';
            if(lista[i].rporcentaje > 100){
                barra.className = 'redFilling';
            } else if (lista[i].rporcentaje < 100){
                barra.className = 'yellowFilling';
            } else {
                barra.className = 'greenFilling';
            }
            var tempDiv = document.createElement('div');
            tempDiv.className = 'tub';
            tempDiv.appendChild(barra);
            container.appendChild(tempDiv);
        }
    }
    
}